<nav aria-label="breadcrumb">
  <ol class="breadcrumb">
    <li class="breadcrumb-item"><a href="/">Home</a></li>
    <li class="breadcrumb-item">Resumen Semanal</li>
  </ol>
</nav>

<% 
  Date.today.to_date.downto(1.week.ago.to_date) do |date| 
  entries = Entry.where(published_date: date.to_date).order(total_count: :desc).limit(10)
  tags = entries.tag_counts_on(:tags).order('count desc')
  tags_interactions = {}
  tags.each do |tag|
    entries.each do |entry|
      tag.interactions ||= 0
      tag.interactions += entry.total_count if entry.tag_list.include?(tag.name)

      tags_interactions[tag.name] ||= 0
      tags_interactions[tag.name] += entry.total_count if entry.tag_list.include?(tag.name)
    end
  end

  tags_interactions = tags_interactions.sort_by { |_k, v| v }
  tags_interactions.reverse
%>
  <h2>Noticias Populares del: <%= date %></h2>
  <hr>
  <div class="my-2">
    <h3>Apariciones Etiquetas</h2>
    <%= render partial: "tag/tag_pill", collection: tags %>
    <p><small class="text-muted px-1">*Cantidad de veces que aparecen las etiquetas en las notas</small></p>
  </div>
  <div class="row" data-masonry='{"percentPosition": true }'>
  <%= render partial: "entry/entry_list", collection: entries, cached: true %>
  </div>
<% end %>