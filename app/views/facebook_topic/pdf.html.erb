<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="utf-8">
    <title>Reporte Facebook: <%= @topic.name %> - Morfeo Analytics</title>
    <!-- Chartkick for Charts -->
    <script src="https://www.gstatic.com/charts/loader.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns@2.0.0/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartkick@4.2.0/dist/chartkick.min.js"></script>

    <%# Auto-print on page load %>
    <script>
      window.onload = function() {
        window.print();
      };
    </script>

    <%# Include professional PDF styles %>
    <%= render 'shared/pdf_professional_styles' %>

    <style>
      /* Facebook-specific color variables */
      :root {
        --fb-primary: #1877f2;
        --fb-secondary: #0c63d4;
      }
    </style>
  </head>
  <body>
    <%# SLIDE 0: Professional Cover Page %>
    <%= render 'shared/pdf_section_wrapper', section_id: 'cover-page' do %>
      <%= render 'shared/pdf_cover_page',
            title: "Reporte Facebook",
            topic_name: @topic.name,
            period: pdf_date_range(days_range: @days_range),
            report_type: :facebook,
            subtitle: "An√°lisis de Reacciones y Sentimiento" %>
    <% end %>

    <%# SLIDE 1: M√©tricas Principales %>
    <%= render 'shared/pdf_section_wrapper', section_id: 'section-1', force_new_page: true do %>
      <%= render 'shared/pdf_slide',
            slide_number: 1,
            title: "M√©tricas Principales",
            subtitle: "Rendimiento General del Per√≠odo",
            report_type: :facebook,
            topic_name: @topic.name do %>

        <%# KPIs en grid 2x2 para mejor visibilidad %>
        <%= render 'shared/pdf_kpi_slide',
            kpis: [
              {
                value: pdf_format_number(@total_posts),
                label: "Posts",
                icon: "üìù",
                sublabel: "publicaciones totales"
              },
              {
                value: pdf_format_number(@total_interactions),
                label: "Interacciones",
                icon: "üëç",
                sublabel: "likes, comentarios, shares"
              },
              {
                value: pdf_format_number(@total_views),
                label: "Vistas",
                icon: "üëÅÔ∏è",
                sublabel: "alcance oficial Meta API"
              },
              {
                value: pdf_format_number(@average_interactions),
                label: "Promedio",
                icon: "üìà",
                sublabel: "interacciones por post"
              }
            ],
            columns: 2,
            size: 'large' %>
      <% end %>
    <% end %>

    <%# SLIDE 2: Evoluci√≥n Temporal %>
    <%= render 'shared/pdf_section_wrapper', section_id: 'section-2', force_new_page: true do %>
      <%= render 'shared/pdf_slide',
          slide_number: 2,
          title: "Evoluci√≥n Temporal",
          subtitle: "Posts e Interacciones por D√≠a",
          report_type: :facebook,
          topic_name: @topic.name do %>

      <%# Gr√°ficas apiladas verticalmente %>
      <div style="display: flex; flex-direction: column; gap: 24pt;">
        <%# Posts por D√≠a %>
        <div>
          <h3 style="margin: 0 0 16pt 0; font-size: 14pt; font-weight: 700; color: #1f2937; padding-left: 12pt; border-left: 4pt solid #1877f2;">
            üìä Posts por D√≠a
          </h3>
          <div style="background: white; border: 2pt solid #e5e7eb; border-radius: 12pt; padding: 20pt; box-shadow: 0 2pt 8pt rgba(0, 0, 0, 0.06);">
            <%= column_chart @chart_posts,
                  colors: ['#1877f2'],
                  height: '240px',
                  library: {
                    chart: { backgroundColor: 'transparent' },
                    xAxis: { labels: { style: { fontSize: '9pt', fontWeight: '600' } } },
                    yAxis: { labels: { style: { fontSize: '9pt', fontWeight: '600' } } }
                  } %>
          </div>
          <p style="margin: 12pt 0 0 0; padding: 12pt 16pt; background: #eff6ff; border-left: 4pt solid #3b82f6; border-radius: 6pt; font-size: 10pt; line-height: 1.6; color: #1e40af;">
            üí° Promedio de <strong><%= (@total_posts.to_f / @days_range).round(1) %></strong> posts por d√≠a durante el per√≠odo analizado.
          </p>
        </div>

        <%# Interacciones por D√≠a %>
        <div>
          <h3 style="margin: 0 0 16pt 0; font-size: 14pt; font-weight: 700; color: #1f2937; padding-left: 12pt; border-left: 4pt solid #10b981;">
            üëç Interacciones por D√≠a
          </h3>
          <div style="background: white; border: 2pt solid #e5e7eb; border-radius: 12pt; padding: 20pt; box-shadow: 0 2pt 8pt rgba(0, 0, 0, 0.06);">
            <%= column_chart @chart_interactions,
                  colors: ['#10b981'],
                  height: '240px',
                  library: {
                    chart: { backgroundColor: 'transparent' },
                    xAxis: { labels: { style: { fontSize: '9pt', fontWeight: '600' } } },
                    yAxis: { labels: { style: { fontSize: '9pt', fontWeight: '600' } } }
                  } %>
          </div>
          <p style="margin: 12pt 0 0 0; padding: 12pt 16pt; background: #d1fae5; border-left: 4pt solid #10b981; border-radius: 6pt; font-size: 10pt; line-height: 1.6; color: #065f46;">
            üí° <%= @chart_interactions.values.max > @chart_interactions.values.min * 2 ? 'Alta variabilidad' : 'Consistencia' %> en las interacciones a lo largo del per√≠odo.
          </p>
        </div>
      </div>
    <% end %>
    <% end %>

    <%# SLIDE 3: An√°lisis de Sentimiento (Overview) %>
    <%= render 'shared/pdf_section_wrapper', section_id: 'section-3', force_new_page: true do %>
    <% if @sentiment_summary.present? %>
      <%
        presenter = FacebookSentimentPresenter.new(
          sentiment_summary: @sentiment_summary,
          sentiment_distribution: @sentiment_distribution,
          sentiment_over_time: @sentiment_over_time,
          reaction_breakdown: @reaction_breakdown,
          top_positive_posts: @top_positive_posts,
          top_negative_posts: @top_negative_posts,
          controversial_posts: @controversial_posts,
          emotional_trends: @emotional_trends
        )
      %>

      <% if presenter.has_data? %>
      <%= render 'shared/pdf_slide',
            slide_number: 3,
            title: "An√°lisis de Sentimiento",
              subtitle: "Basado en Reacciones de Facebook",
              report_type: :facebook,
              topic_name: @topic.name do %>

          <%# KPIs de Sentimiento en grid 2x2 para mejor visibilidad %>
          <%= render 'shared/pdf_kpi_slide',
                kpis: [
                  {
                    value: number_with_precision(presenter.average_sentiment, precision: 2),
                    label: "Score Promedio",
                    icon: pdf_sentiment_emoji(presenter.average_sentiment, system: :facebook),
                    sublabel: presenter.average_sentiment > 0.5 ? 'Positivo' : presenter.average_sentiment < -0.5 ? 'Negativo' : 'Neutral'
                  },
                  {
                    value: "#{(presenter.overall_confidence * 100).round}%",
                    label: "Confianza",
                    icon: "üìä",
                    sublabel: "#{pdf_format_number(presenter.total_reactions)} reacciones"
                  },
                  {
                    value: "#{presenter.positive_percentage}%",
                    label: "Posts Positivos",
                    icon: "üòä",
                    sublabel: "sentimiento positivo"
                  },
                  {
                    value: @controversial_posts&.size || 0,
                    label: "Controvertidos",
                    icon: "‚ö†Ô∏è",
                    sublabel: "alta polarizaci√≥n"
                  }
                ],
                columns: 2,
                size: 'large' %>

          <%# Methodology Note %>
          <div style="background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%); border-left: 6pt solid #3b82f6; border-radius: 12pt; padding: 20pt 24pt; margin-top: 24pt;">
            <h4 style="margin: 0 0 12pt 0; color: #1e40af; font-size: 13pt; display: flex; align-items: center; gap: 8pt;">
              <span style="font-size: 24pt;">üí°</span>
              ¬øC√≥mo medimos el sentimiento?
            </h4>
            <p style="margin: 0 0 12pt 0; font-size: 10pt; line-height: 1.7; color: #1e3a8a;">
              Analizamos autom√°ticamente las <strong>reacciones</strong> que recibe cada post.
              Cada tipo de reacci√≥n tiene un peso emocional que nos permite calcular un score entre
              <span style="color: #ef4444; font-weight: 700;">-2.0 (muy negativo)</span> y
              <span style="color: #10b981; font-weight: 700;">+2.0 (muy positivo)</span>.
            </p>
            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 8pt;">
              <div style="padding: 8pt; background: #d1fae5; border-radius: 6pt; text-align: center;">
                <div style="font-size: 20pt; margin-bottom: 4pt;">‚ù§Ô∏è</div>
                <div style="font-weight: 700; color: #065f46; font-size: 9pt;">Love: +2.0</div>
              </div>
              <div style="padding: 8pt; background: #fef3c7; border-radius: 6pt; text-align: center;">
                <div style="font-size: 20pt; margin-bottom: 4pt;">üòÑ</div>
                <div style="font-weight: 700; color: #92400e; font-size: 9pt;">Haha: +1.5</div>
              </div>
              <div style="padding: 8pt; background: #d1fae5; border-radius: 6pt; text-align: center;">
                <div style="font-size: 20pt; margin-bottom: 4pt;">üëç</div>
                <div style="font-weight: 700; color: #065f46; font-size: 9pt;">Like: +0.5</div>
              </div>
              <div style="padding: 8pt; background: #e0e7ff; border-radius: 6pt; text-align: center;">
                <div style="font-size: 20pt; margin-bottom: 4pt;">üòÆ</div>
                <div style="font-weight: 700; color: #3730a3; font-size: 9pt;">Wow: +1.0</div>
              </div>
              <div style="padding: 8pt; background: #fed7aa; border-radius: 6pt; text-align: center;">
                <div style="font-size: 20pt; margin-bottom: 4pt;">üò¢</div>
                <div style="font-weight: 700; color: #9a3412; font-size: 9pt;">Sad: -1.5</div>
              </div>
              <div style="padding: 8pt; background: #fee2e2; border-radius: 6pt; text-align: center;">
                <div style="font-size: 20pt; margin-bottom: 4pt;">üò†</div>
                <div style="font-weight: 700; color: #991b1b; font-size: 9pt;">Angry: -2.0</div>
              </div>
            </div>
          </div>
        <% end %>
      <% end %>
    <% end %>
    <% end %>

    <%# SLIDE 4: Distribuci√≥n de Sentimiento %>
    <%= render 'shared/pdf_section_wrapper', section_id: 'section-4', force_new_page: true do %>
    <% if @sentiment_summary.present? && @sentiment_distribution.present? %>
      <%
        presenter = FacebookSentimentPresenter.new(
          sentiment_summary: @sentiment_summary,
          sentiment_distribution: @sentiment_distribution,
          sentiment_over_time: @sentiment_over_time,
          reaction_breakdown: @reaction_breakdown,
          top_positive_posts: @top_positive_posts,
          top_negative_posts: @top_negative_posts,
          controversial_posts: @controversial_posts,
          emotional_trends: @emotional_trends
        )
      %>
      <%= render 'shared/pdf_slide',
            slide_number: 4,
            title: "Distribuci√≥n de Sentimiento",
            subtitle: "Posts por Tipo de Sentimiento",
            report_type: :facebook,
            topic_name: @topic.name do %>

        <%
          # Configuraci√≥n de emojis y colores por tipo de sentimiento
          sentiment_config = {
            'Muy Positivo' => { emoji: 'üòÑ', color: '#10b981', bg: '#d1fae5', range: '+1.5 a +2.0', desc: 'Contenido muy bien recibido' },
            'Positivo' => { emoji: 'üôÇ', color: '#22c55e', bg: '#dcfce7', range: '+0.5 a +1.5', desc: 'Contenido bien valorado' },
            'Neutral' => { emoji: 'üòê', color: '#6b7280', bg: '#f3f4f6', range: '-0.5 a +0.5', desc: 'Sin sesgo emocional claro' },
            'Negativo' => { emoji: '‚òπÔ∏è', color: '#f59e0b', bg: '#fef3c7', range: '-1.5 a -0.5', desc: 'Contenido con rechazo' },
            'Muy Negativo' => { emoji: 'üò†', color: '#ef4444', bg: '#fee2e2', range: '-2.0 a -1.5', desc: 'Contenido muy mal recibido' }
          }

          # Obtener distribuci√≥n de sentimientos y convertir a hash si es array
          sentiment_data = presenter.sentiment_distribution_data
          sentiment_dist = sentiment_data.is_a?(Hash) ? sentiment_data : sentiment_data.to_h
          total_posts = sentiment_dist.values.sum
        %>

        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16pt;">
            <% sentiment_dist.sort_by { |k, v| -v }.each_with_index do |(sentiment_name, count), index| %>
              <% config = sentiment_config[sentiment_name] || { emoji: 'üòê', color: '#6b7280', bg: '#f3f4f6', range: 'N/A', desc: sentiment_name } %>
              <% percentage = total_posts > 0 ? (count.to_f / total_posts * 100).round(1) : 0 %>

              <div class="sentiment-card" style="background: white; border: 2pt solid #e5e7eb; border-radius: 10pt; padding: 14pt 16pt; box-shadow: 0 2pt 6pt rgba(0, 0, 0, 0.06); position: relative; overflow: hidden;">
                <%# Background bar (porcentaje visual) %>
                <div style="position: absolute; top: 0; left: 0; height: 100%; width: <%= percentage %>%; background: <%= config[:bg] %>; opacity: 0.5; z-index: 0;"></div>

                <%# Content %>
                <div style="position: relative; z-index: 1;">
                  <%# Header con emoji y nombre %>
                  <div style="display: flex; align-items: center; gap: 10pt; margin-bottom: 10pt;">
                    <div style="flex: 0 0 auto; width: 40pt; height: 40pt; border-radius: 50%; background: <%= config[:bg] %>; display: flex; align-items: center; justify-content: center; font-size: 24pt; border: 2pt solid <%= config[:color] %>;">
                      <%= config[:emoji] %>
                    </div>
                    <div style="flex: 1; min-width: 0;">
                      <div style="font-size: 12pt; font-weight: 800; color: <%= config[:color] %>; line-height: 1;">
                        <%= sentiment_name %>
                      </div>
                      <div style="font-size: 7pt; color: #6b7280; margin-top: 2pt;">
                        <%= config[:desc] %>
                      </div>
                    </div>
                  </div>

                  <%# M√©tricas %>
                  <div style="display: flex; justify-content: space-between; align-items: flex-end;">
                    <div>
                      <div style="font-size: 24pt; font-weight: 900; color: <%= config[:color] %>; line-height: 1; font-feature-settings: 'tnum' 1;">
                        <%= count %>
                      </div>
                      <div style="font-size: 7pt; color: #6b7280; text-transform: uppercase; font-weight: 600; margin-top: 3pt;">
                        posts
                      </div>
                    </div>

                    <div style="text-align: right;">
                      <div style="font-size: 16pt; font-weight: 800; color: <%= config[:color] %>; line-height: 1;">
                        <%= percentage %>%
                      </div>
                      <div style="font-size: 7pt; color: #6b7280; margin-top: 3pt;">
                        del total
                      </div>
                    </div>
                  </div>

                  <%# Sentiment range badge %>
                  <div style="margin-top: 8pt; display: inline-block; padding: 3pt 8pt; background: <%= config[:bg] %>; border-radius: 10pt;">
                    <span style="font-size: 7pt; font-weight: 700; color: <%= config[:color] %>;">
                      üìä Rango: <%= config[:range] %>
                    </span>
                  </div>
                </div>
              </div>
          <% end %>
        </div>

        <%# Insight Bar - M√°s compacto %>
        <div style="display: flex; align-items: center; gap: 10pt; padding: 12pt 16pt; background: linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%); border-left: 4pt solid #10b981; border-radius: 8pt; margin-top: 16pt;">
          <span style="font-size: 24pt; line-height: 1;">üí°</span>
          <p style="margin: 0; font-size: 9pt; font-weight: 600; line-height: 1.4; color: #064e3b;">
            <%= presenter.positive_percentage %>% positivos,
            <%= presenter.neutral_percentage %>% neutrales,
            <%= presenter.negative_percentage %>% negativos.
            Confianza: <%= (presenter.overall_confidence * 100).round %>%.
          </p>
        </div>

        <%# Source note %>
        <p style="margin: 12pt 0 0 0; font-size: 7pt; color: #9ca3af; text-align: center; font-style: italic;">
          An√°lisis: <%= total_posts %> posts | Score: -2.0 a +2.0
        </p>
      <% end %>
    <% end %>
    <% end %>

    <%# SLIDE 5: Desglose de Reacciones %>
    <%= render 'shared/pdf_section_wrapper', section_id: 'section-5' do %>
    <% if @sentiment_summary.present? && @reaction_breakdown.present? %>
      <%
        presenter = FacebookSentimentPresenter.new(
          sentiment_summary: @sentiment_summary,
          sentiment_distribution: @sentiment_distribution,
          sentiment_over_time: @sentiment_over_time,
          reaction_breakdown: @reaction_breakdown,
          top_positive_posts: @top_positive_posts,
          top_negative_posts: @top_negative_posts,
          controversial_posts: @controversial_posts,
          emotional_trends: @emotional_trends
        )
      %>
      <% if presenter.reaction_breakdown_data.present? %>
      <%= render 'shared/pdf_slide',
                slide_number: 5,
                title: "Desglose de Reacciones",
                subtitle: "Tipos de Reacciones Recibidas",
                report_type: :facebook,
                topic_name: @topic.name do %>

        <%#
          Mapeo de emojis y colores por tipo de reacci√≥n
          Emojis oficiales de Facebook
          Soporta nombres en ingl√©s y espa√±ol
          Basado en los pesos de sentimiento de FacebookEntry
        %>
        <%
          reaction_config = {
                # Ingl√©s
                'Like' => { emoji: 'üëç', color: '#3b82f6', bg: '#dbeafe', sentiment: '+0.5', desc: 'Me gusta b√°sico' },
                'Love' => { emoji: '‚ù§Ô∏è', color: '#f43f5e', bg: '#fecdd3', sentiment: '+2.0', desc: 'Amor / Encanta' },
                'Haha' => { emoji: 'üòÜ', color: '#f59e0b', bg: '#fef3c7', sentiment: '+1.5', desc: 'Risa / Divertido' },
                'Wow' => { emoji: 'üòÆ', color: '#a855f7', bg: '#f3e8ff', sentiment: '+1.0', desc: 'Sorpresa / Asombro' },
                'Sad' => { emoji: 'üò¢', color: '#0ea5e9', bg: '#e0f2fe', sentiment: '-1.5', desc: 'Tristeza / Empat√≠a' },
                'Angry' => { emoji: 'üò°', color: '#dc2626', bg: '#fee2e2', sentiment: '-2.0', desc: 'Enojo / Indignaci√≥n' },
                'Care' => { emoji: 'ü§ó', color: '#10b981', bg: '#d1fae5', sentiment: '+2.0', desc: 'Cuidado / Apoyo' },
                'Thankful' => { emoji: 'üôè', color: '#ec4899', bg: '#fce7f3', sentiment: '+2.0', desc: 'Agradecimiento' },
                # Espa√±ol
                'Me Gusta' => { emoji: 'üëç', color: '#3b82f6', bg: '#dbeafe', sentiment: '+0.5', desc: 'Me gusta b√°sico' },
                'Me Encanta' => { emoji: '‚ù§Ô∏è', color: '#f43f5e', bg: '#fecdd3', sentiment: '+2.0', desc: 'Amor / Encanta' },
                'Me Divierte' => { emoji: 'üòÜ', color: '#f59e0b', bg: '#fef3c7', sentiment: '+1.5', desc: 'Risa / Divertido' },
                'Me Asombra' => { emoji: 'üòÆ', color: '#a855f7', bg: '#f3e8ff', sentiment: '+1.0', desc: 'Sorpresa / Asombro' },
                'Me Entristece' => { emoji: 'üò¢', color: '#0ea5e9', bg: '#e0f2fe', sentiment: '-1.5', desc: 'Tristeza / Empat√≠a' },
                'Me Enoja' => { emoji: 'üò°', color: '#dc2626', bg: '#fee2e2', sentiment: '-2.0', desc: 'Enojo / Indignaci√≥n' },
                'Me Importa' => { emoji: 'ü§ó', color: '#10b981', bg: '#d1fae5', sentiment: '+2.0', desc: 'Cuidado / Apoyo' }
              }

              # Ordenar reacciones por cantidad (mayor a menor)
              sorted_reactions = presenter.reaction_breakdown_data.sort_by { |k, v| -v }
              total_reactions = presenter.reaction_breakdown_data.values.sum
            %>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16pt;">
              <% sorted_reactions.take(6).each_with_index do |(reaction_name, count), index| %>
              <% config = reaction_config[reaction_name] || { emoji: 'üëç', color: '#6b7280', bg: '#f3f4f6', sentiment: '0', desc: reaction_name } %>
                <% percentage = total_reactions > 0 ? (count.to_f / total_reactions * 100).round(1) : 0 %>

                <div class="reaction-card" style="background: white; border: 2pt solid #e5e7eb; border-radius: 10pt; padding: 14pt 16pt; box-shadow: 0 2pt 6pt rgba(0, 0, 0, 0.06); position: relative; overflow: hidden;">
                  <%# Background bar (porcentaje visual) %>
                  <div style="position: absolute; top: 0; left: 0; height: 100%; width: <%= percentage %>%; background: <%= config[:bg] %>; opacity: 0.5; z-index: 0;"></div>

                  <%# Content %>
                  <div style="position: relative; z-index: 1;">
                    <%# Header con emoji y nombre %>
                    <div style="display: flex; align-items: center; gap: 10pt; margin-bottom: 10pt;">
                      <div style="flex: 0 0 auto; width: 40pt; height: 40pt; border-radius: 50%; background: <%= config[:bg] %>; display: flex; align-items: center; justify-content: center; font-size: 24pt; border: 2pt solid <%= config[:color] %>;">
                        <%= config[:emoji] %>
                      </div>
                      <div style="flex: 1; min-width: 0;">
                        <div style="font-size: 12pt; font-weight: 800; color: <%= config[:color] %>; line-height: 1;">
                          <%= reaction_name %>
                        </div>
                        <div style="font-size: 7pt; color: #6b7280; margin-top: 2pt;">
                          <%= config[:desc] %>
                        </div>
                      </div>
                    </div>

                    <%# M√©tricas %>
                    <div style="display: flex; justify-content: space-between; align-items: flex-end;">
                      <div>
                        <div style="font-size: 24pt; font-weight: 900; color: <%= config[:color] %>; line-height: 1; font-feature-settings: 'tnum' 1;">
                          <%= pdf_format_number(count) %>
                        </div>
                        <div style="font-size: 7pt; color: #6b7280; text-transform: uppercase; font-weight: 600; margin-top: 3pt;">
                          reacciones
                        </div>
                      </div>

                      <div style="text-align: right;">
                        <div style="font-size: 16pt; font-weight: 800; color: <%= config[:color] %>; line-height: 1;">
                          <%= percentage %>%
                        </div>
                        <div style="font-size: 7pt; color: #6b7280; margin-top: 3pt;">
                          del total
                        </div>
                      </div>
                    </div>

                    <%# Sentiment badge %>
                    <div style="margin-top: 8pt; display: inline-block; padding: 3pt 8pt; background: <%= config[:sentiment].start_with?('-') ? '#fee2e2' : '#d1fae5' %>; border-radius: 10pt;">
                      <span style="font-size: 7pt; font-weight: 700; color: <%= config[:sentiment].start_with?('-') ? '#dc2626' : '#10b981' %>;">
                        <%= config[:sentiment].start_with?('-') ? '‚ñº' : '‚ñ≤' %> Peso: <%= config[:sentiment] %>
                      </span>
                    </div>
                  </div>
                </div>
              <% end %>
            </div>

            <%# Insight Bar - M√°s compacto %>
            <div style="display: flex; align-items: center; gap: 10pt; padding: 12pt 16pt; background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%); border-left: 4pt solid #3b82f6; border-radius: 8pt; margin-top: 16pt;">
              <span style="font-size: 24pt; line-height: 1;">üí°</span>
              <p style="margin: 0; font-size: 9pt; font-weight: 600; line-height: 1.4; color: #1e40af;">
                <%
                  top_reaction_name = sorted_reactions.first[0]
                  top_reaction_count = sorted_reactions.first[1]
                  top_reaction_config = reaction_config[top_reaction_name]
                %>
                <strong><%= top_reaction_name %></strong> predomina con
                <strong><%= pdf_format_number(top_reaction_count) %></strong>
                (<strong><%= (top_reaction_count.to_f / total_reactions * 100).round(1) %>%</strong>),
                generando principalmente
                <strong><%= top_reaction_config ? top_reaction_config[:desc].downcase : 'engagement' %></strong>.
              </p>
            </div>

        <%# Source note %>
        <p style="margin: 12pt 0 0 0; font-size: 7pt; color: #9ca3af; text-align: center; font-style: italic;">
          Fuente: Meta API | Total: <%= pdf_format_number(total_reactions) %> reacciones
        </p>
      <% end %>
      <% end %>
    <% end %>
    <% end %>

    <%# SLIDE 6: Top Posts Positivos %>
    <%= render 'shared/pdf_section_wrapper', section_id: 'section-6' do %>
    <% if @top_positive_posts.present? && @top_positive_posts.any? %>
      <%= render 'shared/pdf_slide',
                slide_number: 6,
                title: "Posts M√°s Positivos",
                subtitle: "Contenido con Mejor Recepci√≥n",
                report_type: :facebook,
                topic_name: @topic.name do %>

        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20pt;">
          <% @top_positive_posts.take(8).each_with_index do |post, index| %>
            <div class="post-card" style="background: white; border: 2pt solid #d1fae5; border-radius: 10pt; padding: 14pt 16pt; box-shadow: 0 2pt 6pt rgba(5, 150, 105, 0.06);">
              <%# Header %>
              <div style="display: flex; align-items: center; gap: 10pt; margin-bottom: 10pt;">
                <span style="display: flex; align-items: center; justify-content: center; width: 28pt; height: 28pt; background: linear-gradient(135deg, #10b981 0%, #059669 100%); color: white; border-radius: 50%; font-size: 12pt; font-weight: 900;">#<%= index + 1 %></span>
                <div style="flex: 1; min-width: 0;">
                  <div style="font-weight: 700; color: #1f2937; font-size: 9pt; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;"><%= post.page&.name || 'Unknown' %></div>
                  <div style="font-size: 7pt; color: #9ca3af;"><%= post.posted_at&.strftime("%d/%m/%Y") %></div>
                  <div style="font-size: 8pt; color: #10b981; font-weight: 700;"><%= pdf_sentiment_emoji(post.sentiment_score, system: :facebook) %> <%= number_with_precision(post.sentiment_score, precision: 2) %></div>
                </div>
              </div>

              <%# Message %>
              <% if post.message.present? %>
                <p style="margin: 0 0 10pt 0; font-size: 8pt; line-height: 1.5; color: #4b5563; height: 48pt; overflow: hidden; text-overflow: ellipsis; display: -webkit-box; -webkit-line-clamp: 4; -webkit-box-orient: vertical;"><%= post.message %></p>
              <% end %>

              <%# Metrics Compact %>
              <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 6pt; font-size: 8pt;">
                <div style="background: #f3f4f6; padding: 6pt; border-radius: 4pt; text-align: center;">
                  <div style="color: #9ca3af;">‚ù§Ô∏è</div>
                  <div style="font-weight: 700; color: #1f2937;"><%= pdf_format_number(post.reactions_total_count) %></div>
                </div>
                <div style="background: #f3f4f6; padding: 6pt; border-radius: 4pt; text-align: center;">
                  <div style="color: #9ca3af;">üí¨</div>
                  <div style="font-weight: 700; color: #1f2937;"><%= pdf_format_number(post.comments_count) %></div>
                </div>
                <div style="background: #f3f4f6; padding: 6pt; border-radius: 4pt; text-align: center;">
                  <div style="color: #9ca3af;">üîó</div>
                  <div style="font-weight: 700; color: #1f2937;"><%= pdf_format_number(post.share_count) %></div>
                </div>
                <% if post.views_count && post.views_count > 0 %>
                  <div style="background: #f3f4f6; padding: 6pt; border-radius: 4pt; text-align: center;">
                    <div style="color: #9ca3af;">üëÅÔ∏è</div>
                    <div style="font-weight: 700; color: #1f2937;"><%= pdf_format_number(post.views_count) %></div>
                  </div>
                <% end %>
              </div>
            </div>
          <% end %>
        </div>
      <% end %>
    <% end %>
    <% end %>

    <%# SLIDE 7: Top Posts Negativos %>
    <%= render 'shared/pdf_section_wrapper', section_id: 'section-7' do %>
    <% if @top_negative_posts.present? && @top_negative_posts.any? %>
      <%= render 'shared/pdf_slide',
                slide_number: 7,
                title: "Posts M√°s Negativos",
                subtitle: "Contenido que Requiere Atenci√≥n",
                report_type: :facebook,
                topic_name: @topic.name do %>

        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20pt;">
          <% @top_negative_posts.take(8).each_with_index do |post, index| %>
            <div class="post-card" style="background: white; border: 2pt solid #fee2e2; border-radius: 10pt; padding: 14pt 16pt; box-shadow: 0 2pt 6pt rgba(220, 38, 38, 0.06);">
              <%# Header %>
              <div style="display: flex; align-items: center; gap: 10pt; margin-bottom: 10pt;">
                <span style="display: flex; align-items: center; justify-content: center; width: 28pt; height: 28pt; background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%); color: white; border-radius: 50%; font-size: 12pt; font-weight: 900;">#<%= index + 1 %></span>
                <div style="flex: 1; min-width: 0;">
                  <div style="font-weight: 700; color: #1f2937; font-size: 9pt; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;"><%= post.page&.name || 'Unknown' %></div>
                  <div style="font-size: 7pt; color: #9ca3af;"><%= post.posted_at&.strftime("%d/%m/%Y") %></div>
                  <div style="font-size: 8pt; color: #ef4444; font-weight: 700;"><%= pdf_sentiment_emoji(post.sentiment_score, system: :facebook) %> <%= number_with_precision(post.sentiment_score, precision: 2) %></div>
                </div>
              </div>

              <%# Message %>
              <% if post.message.present? %>
                <p style="margin: 0 0 10pt 0; font-size: 8pt; line-height: 1.5; color: #4b5563; height: 48pt; overflow: hidden; text-overflow: ellipsis; display: -webkit-box; -webkit-line-clamp: 4; -webkit-box-orient: vertical;"><%= post.message %></p>
              <% end %>

              <%# Metrics Compact %>
              <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 6pt; font-size: 8pt;">
                <div style="background: #f3f4f6; padding: 6pt; border-radius: 4pt; text-align: center;">
                  <div style="color: #9ca3af;">‚ù§Ô∏è</div>
                  <div style="font-weight: 700; color: #1f2937;"><%= pdf_format_number(post.reactions_total_count) %></div>
                </div>
                <div style="background: #f3f4f6; padding: 6pt; border-radius: 4pt; text-align: center;">
                  <div style="color: #9ca3af;">üí¨</div>
                  <div style="font-weight: 700; color: #1f2937;"><%= pdf_format_number(post.comments_count) %></div>
                </div>
                <div style="background: #f3f4f6; padding: 6pt; border-radius: 4pt; text-align: center;">
                  <div style="color: #9ca3af;">üîó</div>
                  <div style="font-weight: 700; color: #1f2937;"><%= pdf_format_number(post.share_count) %></div>
                </div>
                <% if post.views_count && post.views_count > 0 %>
                  <div style="background: #f3f4f6; padding: 6pt; border-radius: 4pt; text-align: center;">
                    <div style="color: #9ca3af;">üëÅÔ∏è</div>
                    <div style="font-weight: 700; color: #1f2937;"><%= pdf_format_number(post.views_count) %></div>
                  </div>
                <% end %>
              </div>
            </div>
          <% end %>
        </div>
      <% end %>
    <% end %>
    <% end %>
    <%# SLIDE 8: An√°lisis por Fanpage %>
    <%= render 'shared/pdf_section_wrapper', section_id: 'section-8', force_new_page: true do %>
    <% if @pages_count.present? && @pages_count.any? %>
      <%= render 'shared/pdf_slide',
            slide_number: 8,
            title: "An√°lisis por Fanpage",
            subtitle: "Distribuci√≥n de Posts e Interacciones",
            report_type: :facebook,
            topic_name: @topic.name do %>

        <%# Lista de Fanpages con Rankings %>
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 32pt;">

          <%# Columna 1: Top Fanpages por Posts %>
          <div>
            <h3 style="margin: 0 0 20pt 0; font-size: 14pt; font-weight: 700; color: #1f2937; padding-left: 12pt; border-left: 4pt solid #1877f2;">
              üìù Top Fanpages por Posts
            </h3>

            <div style="display: flex; flex-direction: column; gap: 12pt;">
              <% @pages_count.take(10).each_with_index do |(page_name, count), index| %>
                <%
                  # Buscar la p√°gina para obtener el avatar
                  page = Page.find_by(name: page_name)
                %>
                <div class="fanpage-item" style="display: flex; align-items: center; gap: 12pt; padding: 12pt 16pt; background: white; border: 1.5pt solid #e5e7eb; border-radius: 10pt; box-shadow: 0 1pt 4pt rgba(0, 0, 0, 0.06);">
                  <%# Ranking Badge %>
                  <div style="flex: 0 0 auto; display: flex; align-items: center; justify-content: center; width: 28pt; height: 28pt; background: linear-gradient(135deg, #1877f2 0%, #0c63d4 100%); color: white; border-radius: 50%; font-size: 12pt; font-weight: 900; box-shadow: 0 2pt 4pt rgba(24, 119, 242, 0.3);">
                    <%= index + 1 %>
                  </div>

                  <%# Avatar %>
                  <% if page&.picture.present? %>
                    <img src="<%= page.picture %>"
                         style="flex: 0 0 auto; width: 40pt; height: 40pt; border-radius: 50%; object-fit: cover; border: 2pt solid #e5e7eb;"
                         onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                    <div style="display: none; flex: 0 0 auto; width: 40pt; height: 40pt; border-radius: 50%; background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%); align-items: center; justify-content: center; font-size: 18pt; border: 2pt solid #93c5fd;">
                      üë§
                    </div>
                  <% else %>
                    <div style="flex: 0 0 auto; width: 40pt; height: 40pt; border-radius: 50%; background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%); display: flex; align-items: center; justify-content: center; font-size: 18pt; border: 2pt solid #93c5fd;">
                      üë§
                    </div>
                  <% end %>

                  <%# Info %>
                  <div style="flex: 1; min-width: 0;">
                    <div style="font-weight: 700; font-size: 10pt; color: #1f2937; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">
                      <%= page_name %>
                    </div>
                    <div style="font-size: 8pt; color: #6b7280; margin-top: 2pt;">
                      Fanpage oficial
                    </div>
                  </div>

                  <%# M√©trica %>
                  <div style="flex: 0 0 auto; text-align: right; padding: 8pt 12pt; background: #eff6ff; border-radius: 6pt;">
                    <div style="font-size: 16pt; font-weight: 900; color: #1877f2; line-height: 1;">
                      <%= count %>
                    </div>
                    <div style="font-size: 7pt; color: #3b82f6; text-transform: uppercase; font-weight: 600; margin-top: 2pt;">
                      posts
                    </div>
                  </div>
                </div>
              <% end %>
            </div>
          </div>

          <%# Columna 2: Top Fanpages por Interacciones %>
          <div>
            <h3 style="margin: 0 0 20pt 0; font-size: 14pt; font-weight: 700; color: #1f2937; padding-left: 12pt; border-left: 4pt solid #10b981;">
              üëç Top Fanpages por Interacciones
            </h3>

            <div style="display: flex; flex-direction: column; gap: 12pt;">
              <% @pages_interactions.sort_by { |k, v| -v }.take(10).each_with_index do |(page_name, interactions), index| %>
                <%
                  # Buscar la p√°gina para obtener el avatar
                  page = Page.find_by(name: page_name)
                %>
                <div class="fanpage-item" style="display: flex; align-items: center; gap: 12pt; padding: 12pt 16pt; background: white; border: 1.5pt solid #e5e7eb; border-radius: 10pt; box-shadow: 0 1pt 4pt rgba(0, 0, 0, 0.06);">
                  <%# Ranking Badge %>
                  <div style="flex: 0 0 auto; display: flex; align-items: center; justify-content: center; width: 28pt; height: 28pt; background: linear-gradient(135deg, #10b981 0%, #059669 100%); color: white; border-radius: 50%; font-size: 12pt; font-weight: 900; box-shadow: 0 2pt 4pt rgba(16, 185, 129, 0.3);">
                    <%= index + 1 %>
                  </div>

                  <%# Avatar %>
                  <% if page&.picture.present? %>
                    <img src="<%= page.picture %>"
                         style="flex: 0 0 auto; width: 40pt; height: 40pt; border-radius: 50%; object-fit: cover; border: 2pt solid #e5e7eb;"
                         onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                    <div style="display: none; flex: 0 0 auto; width: 40pt; height: 40pt; border-radius: 50%; background: linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%); align-items: center; justify-content: center; font-size: 18pt; border: 2pt solid #6ee7b7;">
                      üë§
                    </div>
                  <% else %>
                    <div style="flex: 0 0 auto; width: 40pt; height: 40pt; border-radius: 50%; background: linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%); display: flex; align-items: center; justify-content: center; font-size: 18pt; border: 2pt solid #6ee7b7;">
                      üë§
                    </div>
                  <% end %>

                  <%# Info %>
                  <div style="flex: 1; min-width: 0;">
                    <div style="font-weight: 700; font-size: 10pt; color: #1f2937; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">
                      <%= page_name %>
                    </div>
                    <div style="font-size: 8pt; color: #6b7280; margin-top: 2pt;">
                      <%= @pages_count[page_name] || 0 %> posts
                    </div>
                  </div>

                  <%# M√©trica %>
                  <div style="flex: 0 0 auto; text-align: right; padding: 8pt 12pt; background: #d1fae5; border-radius: 6pt;">
                    <div style="font-size: 16pt; font-weight: 900; color: #10b981; line-height: 1;">
                      <%= pdf_format_number(interactions) %>
                    </div>
                    <div style="font-size: 7pt; color: #059669; text-transform: uppercase; font-weight: 600; margin-top: 2pt;">
                      interac.
                    </div>
                  </div>
                </div>
              <% end %>
            </div>
          </div>

        </div>
      <% end %>
    <% end %>
    <% end %>

    <%# SLIDE 9: An√°lisis por Etiquetas %>
    <%= render 'shared/pdf_section_wrapper', section_id: 'section-9', force_new_page: true do %>
    <% if @tag_counts.present? && @tag_counts.any? %>
      <%= render 'shared/pdf_slide',
            slide_number: 9,
            title: "An√°lisis por Etiquetas",
            subtitle: "Distribuci√≥n de Contenido por Tags",
            report_type: :facebook,
            topic_name: @topic.name do %>

        <%# Lista de Etiquetas con Rankings %>
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 32pt;">

          <%# Columna 1: Top Etiquetas por Posts %>
          <div>
            <h3 style="margin: 0 0 20pt 0; font-size: 14pt; font-weight: 700; color: #1f2937; padding-left: 12pt; border-left: 4pt solid #8b5cf6;">
              üè∑Ô∏è Top Etiquetas por Posts
            </h3>

            <div style="display: flex; flex-direction: column; gap: 12pt;">
              <% @tag_counts.take(10).each_with_index do |tag, index| %>
                <div class="tag-item" style="display: flex; align-items: center; gap: 12pt; padding: 12pt 16pt; background: white; border: 1.5pt solid #e5e7eb; border-radius: 10pt; box-shadow: 0 1pt 4pt rgba(0, 0, 0, 0.06);">
                  <%# Ranking Badge %>
                  <div style="flex: 0 0 auto; display: flex; align-items: center; justify-content: center; width: 28pt; height: 28pt; background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%); color: white; border-radius: 50%; font-size: 12pt; font-weight: 900; box-shadow: 0 2pt 4pt rgba(139, 92, 246, 0.3);">
                    <%= index + 1 %>
                  </div>

                  <%# Tag Icon %>
                  <div style="flex: 0 0 auto; width: 40pt; height: 40pt; border-radius: 50%; background: linear-gradient(135deg, #ede9fe 0%, #ddd6fe 100%); display: flex; align-items: center; justify-content: center; font-size: 18pt; border: 2pt solid #c4b5fd;">
                    üè∑Ô∏è
                  </div>

                  <%# Info %>
                  <div style="flex: 1; min-width: 0;">
                    <div style="font-weight: 700; font-size: 10pt; color: #1f2937; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">
                      <%= tag.name %>
                    </div>
                    <div style="font-size: 8pt; color: #6b7280; margin-top: 2pt;">
                      Etiqueta de contenido
                    </div>
                  </div>

                  <%# M√©trica %>
                  <div style="flex: 0 0 auto; text-align: right; padding: 8pt 12pt; background: #f5f3ff; border-radius: 6pt;">
                    <div style="font-size: 16pt; font-weight: 900; color: #8b5cf6; line-height: 1;">
                      <%= tag.count %>
                    </div>
                    <div style="font-size: 7pt; color: #7c3aed; text-transform: uppercase; font-weight: 600; margin-top: 2pt;">
                      posts
                    </div>
                  </div>
                </div>
              <% end %>
            </div>
          </div>

          <%# Columna 2: Top Etiquetas por Interacciones %>
          <div>
            <h3 style="margin: 0 0 20pt 0; font-size: 14pt; font-weight: 700; color: #1f2937; padding-left: 12pt; border-left: 4pt solid #10b981;">
              üëç Top Etiquetas por Interacciones
            </h3>

            <div style="display: flex; flex-direction: column; gap: 12pt;">
              <% @tag_interactions.sort_by { |k, v| -v }.take(10).each_with_index do |(tag_name, interactions), index| %>
                <%
                  # Buscar el objeto tag para obtener el count
                  tag_obj = @tag_counts.find { |t| t.name == tag_name }
                %>
                <div class="tag-item" style="display: flex; align-items: center; gap: 12pt; padding: 12pt 16pt; background: white; border: 1.5pt solid #e5e7eb; border-radius: 10pt; box-shadow: 0 1pt 4pt rgba(0, 0, 0, 0.06);">
                  <%# Ranking Badge %>
                  <div style="flex: 0 0 auto; display: flex; align-items: center; justify-content: center; width: 28pt; height: 28pt; background: linear-gradient(135deg, #10b981 0%, #059669 100%); color: white; border-radius: 50%; font-size: 12pt; font-weight: 900; box-shadow: 0 2pt 4pt rgba(16, 185, 129, 0.3);">
                    <%= index + 1 %>
                  </div>

                  <%# Tag Icon %>
                  <div style="flex: 0 0 auto; width: 40pt; height: 40pt; border-radius: 50%; background: linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%); display: flex; align-items: center; justify-content: center; font-size: 18pt; border: 2pt solid #6ee7b7;">
                    üè∑Ô∏è
                  </div>

                  <%# Info %>
                  <div style="flex: 1; min-width: 0;">
                    <div style="font-weight: 700; font-size: 10pt; color: #1f2937; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">
                      <%= tag_name %>
                    </div>
                    <div style="font-size: 8pt; color: #6b7280; margin-top: 2pt;">
                      <%= tag_obj&.count || 0 %> posts
                    </div>
                  </div>

                  <%# M√©trica %>
                  <div style="flex: 0 0 auto; text-align: right; padding: 8pt 12pt; background: #d1fae5; border-radius: 6pt;">
                    <div style="font-size: 16pt; font-weight: 900; color: #10b981; line-height: 1;">
                      <%= pdf_format_number(interactions) %>
                    </div>
                    <div style="font-size: 7pt; color: #059669; text-transform: uppercase; font-weight: 600; margin-top: 2pt;">
                      interac.
                    </div>
                  </div>
                </div>
              <% end %>
            </div>
          </div>

        </div>
      <% end %>
    <% end %>
    <% end %>

    <%# SLIDE 10: Top Posts Generales %>
    <%= render 'shared/pdf_section_wrapper', section_id: 'section-10', force_new_page: true do %>
    <% if @top_posts.present? && @top_posts.any? %>
      <%= render 'shared/pdf_slide',
            slide_number: 10,
            title: "Posts con M√°s Interacciones",
            subtitle: "Contenido de Mayor Impacto",
            report_type: :facebook,
            topic_name: @topic.name do %>

        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20pt;">
          <% @top_posts.take(8).each_with_index do |post, index| %>
            <div class="post-card" style="background: white; border: 2pt solid #e5e7eb; border-radius: 10pt; padding: 14pt 16pt; box-shadow: 0 2pt 6pt rgba(0, 0, 0, 0.06);">
              <%# Header %>
              <div style="display: flex; align-items: center; gap: 10pt; margin-bottom: 10pt;">
                <span style="display: flex; align-items: center; justify-content: center; width: 28pt; height: 28pt; background: linear-gradient(135deg, #1877f2 0%, #0c63d4 100%); color: white; border-radius: 50%; font-size: 12pt; font-weight: 900;">#<%= index + 1 %></span>
                <div style="flex: 1; min-width: 0;">
                  <div style="font-weight: 700; color: #1f2937; font-size: 9pt; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;"><%= post.page&.name || 'Unknown' %></div>
                  <div style="font-size: 7pt; color: #9ca3af;"><%= post.posted_at&.strftime("%d/%m/%Y") %></div>
                </div>
              </div>

              <%# Message %>
              <% if post.message.present? %>
                <p style="margin: 0 0 10pt 0; font-size: 8pt; line-height: 1.5; color: #4b5563; height: 48pt; overflow: hidden; text-overflow: ellipsis; display: -webkit-box; -webkit-line-clamp: 4; -webkit-box-orient: vertical;"><%= post.message %></p>
              <% end %>

              <%# Metrics Compact %>
              <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 6pt; font-size: 8pt;">
                <div style="background: #f3f4f6; padding: 6pt; border-radius: 4pt; text-align: center;">
                  <div style="color: #9ca3af;">‚ù§Ô∏è</div>
                  <div style="font-weight: 700; color: #1f2937;"><%= pdf_format_number(post.reactions_total_count) %></div>
                </div>
                <div style="background: #f3f4f6; padding: 6pt; border-radius: 4pt; text-align: center;">
                  <div style="color: #9ca3af;">üí¨</div>
                  <div style="font-weight: 700; color: #1f2937;"><%= pdf_format_number(post.comments_count) %></div>
                </div>
                <div style="background: #f3f4f6; padding: 6pt; border-radius: 4pt; text-align: center;">
                  <div style="color: #9ca3af;">üîó</div>
                  <div style="font-weight: 700; color: #1f2937;"><%= pdf_format_number(post.share_count) %></div>
                </div>
                <% if post.views_count && post.views_count > 0 %>
                  <div style="background: #f3f4f6; padding: 6pt; border-radius: 4pt; text-align: center;">
                    <div style="color: #9ca3af;">üëÅÔ∏è</div>
                    <div style="font-weight: 700; color: #1f2937;"><%= pdf_format_number(post.views_count) %></div>
                  </div>
                <% end %>
              </div>
            </div>
          <% end %>
        </div>
      <% end %>
    <% end %>
    <% end %>

  </body>
</html>
